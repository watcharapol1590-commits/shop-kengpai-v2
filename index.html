<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kengpai Shop V2 - ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ó‡∏≥‡∏õ‡πâ‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
        .item-card { cursor: pointer; border: 2px solid transparent; transition: all 0.2s; position: relative; }
        .item-card.selected { border-color: #4f46e5; background-color: #eef2ff; transform: scale(1.02); }
        .item-card.selected::after { content: '‚úì'; position: absolute; top: 2px; right: 5px; background: #4f46e5; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; display: flex; align-items: center; justify-content: center; }
        .img-container { aspect-ratio: 1/1; overflow: hidden; border-radius: 0.75rem; background: #fff; border: 1px solid #e2e8f0; }
        .img-container img { width: 100%; height: 100%; object-fit: contain; }
        .sticky-summary { position: sticky; top: 0; z-index: 100; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="pb-20">

    <div id="app-container" class="max-w-md mx-auto bg-white min-h-screen shadow-2xl">
        <div class="bg-indigo-700 p-8 text-white text-center rounded-b-[40px] shadow-lg">
            <h1 class="text-3xl font-bold uppercase tracking-widest">KENGPAI V2</h1>
            <p class="text-indigo-100 text-sm mt-1">Professional Nameplate System</p>
        </div>

        <div class="sticky-summary p-4 border-b flex justify-between items-center shadow-sm">
            <div>
                <p class="text-[10px] font-bold text-gray-400 uppercase">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏ú‡πà‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</p>
                <p class="text-2xl font-bold text-indigo-600"><span id="currentPrice">0</span> ‡∏ö‡∏≤‡∏ó</p>
            </div>
            <button onclick="addToCart()" class="bg-indigo-600 text-white px-8 py-3 rounded-full font-bold shadow-lg active:scale-95 transition hover:bg-indigo-700">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
        </div>

        <div class="p-4 space-y-10" id="main-content"></div>

        <div class="p-4">
            <div id="textSection" class="bg-slate-900 p-6 rounded-[32px] space-y-4 shadow-xl border-4 border-indigo-500/30">
                <h3 class="text-white text-center font-bold text-lg">‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ö‡∏ô‡∏õ‡πâ‡∏≤‡∏¢</h3>
                <div id="input-container" class="space-y-3">
                    <input type="text" id="txt-line1" placeholder="‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 1 (‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)" class="w-full p-4 rounded-2xl border-none focus:ring-4 ring-indigo-500 outline-none text-lg text-center font-bold">
                    <input type="text" id="txt-line2" placeholder="‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 2 (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á)" class="w-full p-4 rounded-2xl border-none focus:ring-4 ring-indigo-500 outline-none text-lg text-center font-bold hidden">
                    <input type="text" id="txt-line3" placeholder="‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 3 (‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏≠‡∏∑‡πà‡∏ô‡πÜ)" class="w-full p-4 rounded-2xl border-none focus:ring-4 ring-indigo-500 outline-none text-lg text-center font-bold hidden">
                </div>
            </div>
        </div>

        <div id="cartArea" class="p-6 bg-slate-50 border-t-8 border-slate-100">
            <h2 class="text-xl font-bold mb-4 flex justify-between items-center">
                <span>üõí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
                <span id="cartCount" class="bg-indigo-600 text-white text-xs px-3 py-1 rounded-full">0</span>
            </h2>
            <div id="cartList" class="space-y-3"></div>
            
            <div id="checkoutBox" class="mt-8 hidden space-y-4">
                <div class="bg-white border-2 border-indigo-100 p-6 rounded-[32px] shadow-md space-y-4">
                    <p class="font-bold text-lg border-b pb-2 text-indigo-800">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</p>
                    <input type="text" id="custName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö" class="w-full p-4 border rounded-2xl outline-none focus:ring-2 ring-indigo-500">
                    <input type="tel" id="custPhone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå" class="w-full p-4 border rounded-2xl outline-none focus:ring-2 ring-indigo-500">
                    <textarea id="custAddr" placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÇ‡∏î‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" class="w-full p-4 border rounded-2xl outline-none focus:ring-2 ring-indigo-500" rows="3"></textarea>
                    
                    <div class="p-5 bg-indigo-50 rounded-[24px] space-y-2 border border-indigo-100">
                        <div class="flex justify-between text-sm text-gray-600"><span>‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</span> <span id="subTotalDisplay">0 ‡∏ö‡∏≤‡∏ó</span></div>
                        <div class="flex justify-between text-sm text-green-600 font-bold"><span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</span> <span>+ 40 ‡∏ö‡∏≤‡∏ó</span></div>
                        <div class="flex justify-between text-2xl font-bold border-t border-indigo-200 pt-2 mt-2">
                            <span>‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</span> 
                            <span id="grandTotalDisplay" class="text-indigo-700">0 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>
                    
                    <button onclick="submitOrder()" id="btnSubmit" class="w-full bg-green-600 text-white py-5 rounded-2xl font-bold text-xl shadow-xl active:scale-95 transition hover:bg-green-700">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwF07YaoGYtv_-Fl7Hm6RmcKWuhkTu7K7qWc2YcY_s-6mvidJJjtL5tRfXsGxKewMpj/exec";

        const getImg = (url) => {
            if(!url) return "https://via.placeholder.com/150?text=Kengpai";
            const id = url.match(/[-\w]{25,}/);
            return id ? `https://drive.google.com/thumbnail?id=${id[0]}&sz=400` : url;
        }

        const db = [
            { id: 1, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏Ñ‡∏¥‡∏•‡∏¥‡∏Ñ", price: 100, cat: "material", img: "https://drive.google.com/file/d/1klCw3wrT398UeutTY8B4bZSTJPxv4S3r/view" },
            { id: 2, name: "‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏°‡πâ‡∏°‡∏∞‡∏Ç‡∏≤‡∏°", price: 120, cat: "material", img: "https://drive.google.com/file/d/13UxNtFF-DppQB0Ls7xp7IsRvcKUwsweB/view" },
            { id: 3, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", price: 100, cat: "material", img: "https://drive.google.com/file/d/1RgwekNK5w-ECkxMVg0E9SmaQCEPGhphj/view" },
            { id: 4, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏π‡∏ô‡∏ä‡∏∏‡∏õ‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö", price: 150, cat: "material", img: "https://drive.google.com/file/d/1mLGLdA4BZaB5kuG3rGgHQJSJy60s9HJI/view" },
            { id: 5, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏π‡∏ô‡∏ä‡∏∏‡∏õ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö", price: 150, cat: "material", img: "https://drive.google.com/file/d/1cSiErvvO-RDqSiKDtMtFQB2zXFmpf9S1/view" },
            { id: 6, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏π‡∏ô‡∏ä‡∏∏‡∏õ‡∏ó‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö", price: 200, cat: "material", img: "https://drive.google.com/file/d/1Pu-_p0c4ZAMNlVj1wPrbeI4TO98yImhZ/view" },
            { id: 7, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏π‡∏ô‡∏ä‡∏∏‡∏õ‡∏ó‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö", price: 200, cat: "material", img: "https://drive.google.com/file/d/1t2XBGzAEBhK6kTqMr5yaqHdFDh5ZrHdj/view" },
            { id: 8, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏á‡∏≤‡∏ä‡∏∏‡∏õ‡πÄ‡∏á‡∏¥‡∏ô", price: 180, cat: "material", img: "https://drive.google.com/file/d/1sfMoGiwG2ZVyc1WbvaGHfjkCAG3BBqBi/view" },
            { id: 9, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏á‡∏≤‡∏ä‡∏∏‡∏õ‡∏ó‡∏≠‡∏á", price: 200, cat: "material", img: "https://drive.google.com/file/d/1Z7OxlZAD9HHp4dQ7rOVC80HqeaekXzl6/view" },
            { id: 10, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏£‡∏≤‡∏¢‡∏ä‡∏∏‡∏õ‡πÄ‡∏á‡∏¥‡∏ô", price: 180, cat: "material", img: "https://drive.google.com/file/d/1ue5jxh_gdR_PLXhT-1JOahRRYkIpotod/view" },
            { id: 11, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏£‡∏≤‡∏¢‡∏ä‡∏∏‡∏õ‡∏ó‡∏≠‡∏á", price: 200, cat: "material", img: "https://drive.google.com/file/d/11p-TC8S77w64fa00IE-sLWx3Ws08O-4g/view" },
            { id: 12, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏ö‡πÄ‡∏á‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏£‡∏≤‡∏¢‡∏ä‡∏∏‡∏õ‡πÄ‡∏á‡∏¥‡∏ô", price: 180, cat: "material", img: "https://drive.google.com/file/d/1v2e6gmJFC4qbaTEWSo6U1GO_ym2F4QNj/view" },
            { id: 13, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏ö‡πÄ‡∏á‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏£‡∏≤‡∏¢‡∏ä‡∏∏‡∏õ‡∏ó‡∏≠‡∏á", price: 200, cat: "material", img: "https://drive.google.com/file/d/1UYaeVGg8J6P5p5xsG8k-Gsz41VKpH22J/view" },
            { id: 14, name: "‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡πÇ‡∏•‡πÇ‡∏Å‡πâ", price: 0, cat: "logo", img: "" },
            { id: 15, name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£", price: 0, cat: "logo", img: "https://drive.google.com/file/d/1Q870c5Vc2A1WNoImBQaMgcg5o7Qmt_96/view" },
            { id: 16, name: "‡∏ß‡∏õ‡∏£", price: 30, cat: "logo", img: "https://drive.google.com/file/d/1iqKnYDCAAQ3dkKPL7RyNkeDfNogmayIv/view" },
            { id: 17, name: "‡∏ï‡∏≥‡∏£‡∏ß‡∏à", price: 0, cat: "logo", img: "https://drive.google.com/file/d/1mLGLdA4BZaB5kuG3rGgHQJSJy60s9HJI/view" },
            { id: 18, name: "‡πÄ‡∏™‡∏°‡∏≤", price: 0, cat: "logo", img: "https://drive.google.com/file/d/1EddGi7R6MCmq-_VSwGPLgOwtCXh3PdNA/view" },
            { id: 19, name: "‡∏Ñ‡∏£‡∏π‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô", price: 0, cat: "logo", img: "https://drive.google.com/file/d/1G57dabHH9HaBt73Cn4XANppKmY-HADni/view" },
            { id: 20, name: "‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ß‡∏á‡∏Å‡∏•‡∏°", price: 0, cat: "logo", img: "https://drive.google.com/file/d/19_1Jx5gWiOqKY1mS8Rcd9vXxbY1lsHlV/view" },
            { id: 21, name: "‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç", price: 0, cat: "logo", img: "https://drive.google.com/file/d/1qiEV8gRij9RqD1z97yrPFIxupD1euy_9/view" },
            { id: 22, name: "‡πÄ‡∏Å‡∏©‡∏ï‡∏£", price: 0, cat: "logo", img: "https://drive.google.com/file/d/1sYdIbf4F1wfhiFgTiEJCprie2YCu_i1L/view" },
            { id: 23, name: "‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏†‡∏π‡∏°‡∏¥‡∏†‡∏≤‡∏Ñ", price: 0, cat: "logo", img: "https://drive.google.com/file/d/191RoYWjjIrNtUcdyH7PpaHvSFwVRS9Vw/view" },
            { id: 24, name: "‡∏Å‡∏ó‡∏°", price: 0, cat: "logo", img: "https://drive.google.com/file/d/1Tu4WVAY--acmYVpUsbPBKN0mbV775QiI/view" },
            { id: 25, name: "‡∏≠‡∏∑‡πà‡∏ô‡πÜ(‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏π‡∏õ)", price: 0, cat: "logo", img: "" },
            { id: 26, name: "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì", price: 0, cat: "font", img: "https://drive.google.com/file/d/17WVoz3H4KJpoJhcVGLBLaz_tqhuhunvc/view" },
            { id: 27, name: "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏≠‡∏≤‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå", price: 0, cat: "font", img: "https://drive.google.com/file/d/1EuC8TStvoeN6NgDMmujlqwOy3ytgcUcF/view" },
            { id: 28, name: "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏ß‡∏£‡∏£‡∏ì‡∏£‡∏µ", price: 0, cat: "font", img: "https://drive.google.com/file/d/1Z7hUNDYxvRckkxD8vTPCnnTYncTTJzNP/view" },
            { id: 29, name: "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÄ‡∏≠‡∏Å‡∏ä‡∏±‡∏¢", price: 0, cat: "font", img: "https://drive.google.com/file/d/1iqk4t2dAnrn1ipeJde4f8W-db-5_78Uc/view" },
            { id: 30, name: "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡∏Å‡∏≤", price: 0, cat: "font", img: "https://drive.google.com/file/d/1ObmsAY1cnc1Wx22qe_qJ5VYEPLNDYxvd/view" },
            { id: 31, name: "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏®‡∏±‡∏Å‡∏®‡∏¥‡∏©‡∏¢‡πå", price: 0, cat: "font", img: "https://drive.google.com/file/d/1mXbO_H9XLOiDFsfBJgCPlbYLHw1NC8O_/view" },
            { id: 32, name: "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ", price: 0, cat: "font", img: "" },
            { id: 33, name: "1.5 X 7.0 (‡∏ï‡∏≥‡∏£‡∏ß‡∏à)", price: 0, cat: "size", img: "https://drive.google.com/file/d/1kL-zKRn_AcDtwXCXF7kCeacsdBEIyyL7/view" },
            { id: 34, name: "1.5 X 7.5 (‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏•‡πá‡∏Å)", price: 0, cat: "size", img: "https://drive.google.com/file/d/1kL-zKRn_AcDtwXCXF7kCeacsdBEIyyL7/view" },
            { id: 35, name: "2.0 X 7.5 (‡∏Ç‡∏ô‡∏≤‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô/‡∏ó‡∏´‡∏≤‡∏£)", price: 0, cat: "size", img: "https://drive.google.com/file/d/1kL-zKRn_AcDtwXCXF7kCeacsdBEIyyL7/view" },
            { id: 36, name: "2.5 X 7.5 (‡∏õ‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà)", price: 20, cat: "size", img: "https://drive.google.com/file/d/1kL-zKRn_AcDtwXCXF7kCeacsdBEIyyL7/view" },
            { id: 37, name: "1 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î", price: 0, cat: "lines", count: 1 },
            { id: 38, name: "2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î", price: 0, cat: "lines", count: 2 },
            { id: 39, name: "3 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î", price: 0, cat: "lines", count: 3 },
            { id: 40, name: "‡∏Ç‡∏≤‡πÄ‡∏Ç‡πá‡∏°‡∏Å‡∏•‡∏±‡∏î", price: 0, cat: "attachment", img: "https://drive.google.com/file/d/1sjBKC_qs07JndLRE20OMKZl5j-wWgWBV/view" },
            { id: 41, name: "‡∏Ç‡∏≤‡∏´‡∏°‡∏∏‡∏î(‡∏Å‡∏¥‡πä‡∏ü‡∏•‡πä‡∏≠‡∏Ñ)", price: 0, cat: "attachment", img: "https://drive.google.com/file/d/1sjBKC_qs07JndLRE20OMKZl5j-wWgWBV/view" },
            { id: 42, name: "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏•‡πá‡∏Å", price: 50, cat: "attachment", img: "https://drive.google.com/file/d/1sjBKC_qs07JndLRE20OMKZl5j-wWgWBV/view" },
            { id: 43, name: "‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡πÄ‡∏£‡∏ã‡∏¥‡πà‡∏ô", price: 0, cat: "finish", img: "https://drive.google.com/file/d/1mLGLdA4BZaB5kuG3rGgHQJSJy60s9HJI/view" },
            { id: 44, name: "‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡πÄ‡∏£‡∏ã‡∏¥‡πà‡∏ô", price: 0, cat: "finish", img: "https://drive.google.com/file/d/1mLGLdA4BZaB5kuG3rGgHQJSJy60s9HJI/view" }
        ];

        let selections = { material: 1, logo: 14, font: 26, size: 33, lines: 37, attachment: 40, finish: 43 };
        let cart = [];

        function renderOptions() {
            const groups = [
                { label: "1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏õ‡πâ‡∏≤‡∏¢", cat: "material", cols: 2 },
                { label: "2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏•‡πÇ‡∏Å‡πâ", cat: "logo", cols: 3 },
                { label: "3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡πâ‡∏≤‡∏¢", cat: "size", cols: 2 },
                { label: "4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏≠‡∏ô‡∏ï‡πå", cat: "font", cols: 2 },
                { label: "5. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á", cat: "attachment", cols: 3 },
                { label: "6. ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö", cat: "finish", cols: 2 },
                { label: "7. ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î", cat: "lines", cols: 3 }
            ];
            const container = document.getElementById('main-content');
            container.innerHTML = groups.map(g => `
                <div>
                    <h2 class="font-bold text-gray-800 mb-4 border-l-4 border-indigo-600 pl-3 uppercase tracking-wide text-sm">${g.label}</h2>
                    <div class="grid grid-cols-${g.cols} gap-3">
                        ${db.filter(i => i.cat === g.cat).map(item => `
                            <div onclick="selectItem('${g.cat}', ${item.id})" class="item-card p-3 bg-white rounded-2xl shadow-sm text-center ${selections[g.cat] == item.id ? 'selected' : ''}">
                                ${item.img ? `<div class="img-container mb-2"><img src="${getImg(item.img)}"></div>` : ''}
                                <div class="text-[10px] font-bold leading-tight h-8 flex items-center justify-center">${item.name}</div>
                                <div class="text-[10px] text-indigo-600 font-bold mt-1">${item.price > 0 ? '+'+item.price+'.-' : '‡∏ü‡∏£‡∏µ'}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
            updateUI();
        }

        function selectItem(cat, id) { selections[cat] = id; renderOptions(); }

        function updateUI() {
            let total = 0;
            for(let key in selections) total += db.find(i => i.id == selections[key]).price;
            document.getElementById('currentPrice').innerText = total;
            const lineCount = db.find(i => i.id == selections.lines).count;
            document.getElementById('txt-line2').classList.toggle('hidden', lineCount < 2);
            document.getElementById('txt-line3').classList.toggle('hidden', lineCount < 3);
        }

        function addToCart() {
            const l1 = document.getElementById('txt-line1').value;
            const l2 = document.getElementById('txt-line2').value;
            const l3 = document.getElementById('txt-line3').value;
            if(!l1) return alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏õ‡πâ‡∏≤‡∏¢");

            let desc = ""; let price = 0;
            for(let k in selections) {
                const item = db.find(i => i.id == selections[k]);
                desc += item.name + " / ";
                price += item.price;
            }
            desc = desc.replace(/ \/ $/, "");
            const lineCount = db.find(i => i.id == selections.lines).count;
            let msg = l1 + (lineCount >= 2 ? " | "+(l2||"-") : "") + (lineCount >= 3 ? " | "+(l3||"-") : "");

            cart.push({ desc, msg, price });
            renderCart();
            document.getElementById('txt-line1').value = "";
            document.getElementById('txt-line2').value = "";
            document.getElementById('txt-line3').value = "";
            alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß");
        }

        function renderCart() {
            const list = document.getElementById('cartList');
            let sub = 0;
            if(cart.length === 0) {
                list.innerHTML = `<p class="text-center text-gray-400 py-8 text-sm italic">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</p>`;
                document.getElementById('checkoutBox').classList.add('hidden');
                document.getElementById('cartCount').innerText = "0";
                return;
            }
            list.innerHTML = cart.map((item, idx) => {
                sub += item.price;
                return `<div class="bg-white p-4 rounded-2xl border border-indigo-50 flex justify-between items-start text-[11px] shadow-sm relative">
                    <div class="flex-1 pr-4">
                        <b class="text-indigo-900 block mb-1">${item.desc}</b>
                        <span class="text-indigo-600 font-bold block bg-indigo-50 p-1 rounded">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: ${item.msg}</span>
                        <span class="text-gray-400 text-[10px] mt-1 block font-bold">‡∏£‡∏≤‡∏Ñ‡∏≤: ${item.price} ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <button onclick="cart.splice(${idx},1);renderCart()" class="text-red-400 font-bold p-1 hover:text-red-600">‡∏•‡∏ö</button>
                </div>`;
            }).join('');
            document.getElementById('cartCount').innerText = cart.length;
            document.getElementById('subTotalDisplay').innerText = sub + " ‡∏ö‡∏≤‡∏ó";
            document.getElementById('grandTotalDisplay').innerText = (sub + 40) + " ‡∏ö‡∏≤‡∏ó";
            document.getElementById('checkoutBox').classList.remove('hidden');
        }

        async function submitOrder() {
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            const addr = document.getElementById('custAddr').value;
            
            if(!name || !phone || !addr) return alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");

            const btn = document.getElementById('btnSubmit');
            btn.disabled = true; 
            btn.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå...";

            // 1. ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏¥‡πâ‡∏ô (‡πÅ‡∏¢‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢)
            const itemDetails = cart.map((i, idx) => {
                return `üìç ‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà ${idx + 1}\n‡∏™‡πÄ‡∏õ‡∏Å: ${i.desc}\n‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: ${i.msg}\n‡∏£‡∏≤‡∏Ñ‡∏≤: ${i.price} ‡∏ö‡∏≤‡∏ó`;
            }).join('\n--------------------------\n');

            const subTotal = cart.reduce((sum, item) => sum + item.price, 0);
            const shipping = 40;
            const grandTotal = subTotal + shipping;

            // 2. ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheets
            const finalFullSummary = `
[ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠ ]
‡∏ä‡∏∑‡πà‡∏≠: ${name}
‡πÇ‡∏ó‡∏£: ${phone}
‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${addr}

[ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ]
${itemDetails}

--------------------------
‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${subTotal} ‡∏ö‡∏≤‡∏ó
‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á: ${shipping} ‡∏ö‡∏≤‡∏ó
üí∞ ‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏£‡∏ß‡∏°: ${grandTotal} ‡∏ö‡∏≤‡∏ó
            `.trim();

            const payload = {
                name: name,
                phone: phone,
                address: addr,
                items: finalFullSummary, 
                total: grandTotal + " ‡∏ö‡∏≤‡∏ó"
            };

            try {
                const res = await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(payload) });
                const result = await res.json();
                if(result.status === "success") {
                    showSuccess(name, itemDetails, subTotal, shipping, grandTotal);
                } else {
                    throw new Error("Server Error");
                }
            } catch (e) { 
                alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"); 
                btn.disabled = false; 
                btn.innerText = "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠"; 
            }
        }

        function showSuccess(name, items, sub, ship, total) {
            document.getElementById('app-container').innerHTML = `
                <div class="p-8 text-center space-y-6">
                    <div class="text-7xl animate-bounce">üéâ</div>
                    <h2 class="text-3xl font-bold text-indigo-700">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h2>
                    <p class="text-gray-600 text-sm italic">‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡∏£‡∏µ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö</p>
                    
                    <div class="bg-white p-6 rounded-[32px] text-left text-xs space-y-4 shadow-inner border-2 border-dashed border-indigo-200">
                        <p class="font-bold border-b pb-2 text-indigo-500 text-sm">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
                        <div style="white-space: pre-line;" class="text-gray-800 leading-relaxed font-medium">${items}</div>
                        
                        <div class="border-t border-indigo-100 pt-3 space-y-1">
                            <div class="flex justify-between"><span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</span> <span>${sub} ‡∏ö‡∏≤‡∏ó</span></div>
                            <div class="flex justify-between text-green-600"><span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</span> <span>+ ${ship} ‡∏ö‡∏≤‡∏ó</span></div>
                            <div class="flex justify-between font-bold text-indigo-700 text-xl pt-2">
                                <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</span>
                                <span>${total} ‡∏ö‡∏≤‡∏ó</span>
                            </div>
                        </div>
                    </div>

                    <button onclick="location.reload()" class="w-full bg-indigo-600 text-white py-5 rounded-2xl font-bold shadow-xl hover:bg-indigo-700 transition">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                    <p class="text-[10px] text-gray-400">Kengpai Shop V2 ‚Ä¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏£‡∏≤</p>
                </div>
            `;
            window.scrollTo(0,0);
        }

        renderOptions();
    </script>
</body>
</html>
